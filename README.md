# Java code for "Linearity of a drug response curve observed and explained in a hybrid model for SARS–CoV–2".

The Java file uses and is dependent on the Hybrid Autmata Library (HAL) software package, for more information see https://halloworld.org/.

The main goal of the project is to examine the probability of early extinction of SARS--CoV--2 infection, where the probability of stochastic extinction is described as a function of the virus clearance parameter.
There are two main modes in the code: the variable experimentalOrTheoretical can be set to either "experimental" and "theoretical".

The "experimental" switch allows us to run simulations that correspond to the natural course of SARS--CoV--2 infection. In order to determine the *experimental* probability of early extinction, the code executes 1000 randomized simulations with the same initial condition. In each case a single infected cell is placed in the geometric center of a 200 x 200 cell grid with zero initial virus concentration. The one infected cell we have in the beginning either dies instantly or starts producing virions, which in turn may infect further cells, which produce more virions, etc. Naturally, stochastic extinction typically happens in the early phase of infection, when only a few cells are infected. If these few cells stochastically die before infection could be established, the host is "saved" from a large-scale infection and the case is classified as an early extinction case. The experimental probability of extinction is calculated by counting the number of cases where early infection extinction happens (i.e. where at least 99% of the cells remain uninfected). For example, if 237 simulations result in early extinction, then the experimental probability of extinction is 237 / 1000 = 0.237.

The code also serves as a tool to better understand the behaviour of formerly determined experimental probability of extinction. This is achieved by producing data on offspring distribution. This mode can be used with the "theoretical" switch. This mode, too, works with 1000 simulations, but here the newly infected cells do not produce virions -- only the single original infected cell does. This way we are able to measure precisely the number of offsprings of the one original infected cell. The offspring distribution can be used to explain the results observed for the experimental probability of extinction. Naturally, the "theoretical" mode also allows us to determine the empirical R0 value. For more detail, see the article with the same title.
